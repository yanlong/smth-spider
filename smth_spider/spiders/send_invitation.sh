#!/bin/bash
user=$1

result=$(curl 'http://www.newsmth.net/nForum/mail/NULL/ajax_send.json'  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.108 Safari/537.36' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'Accept: */*' -H 'Cache-Control: no-cache' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: main[UTMPUSERID]=gomypig; main[UTMPKEY]=73051396; main[UTMPNUM]=17059; main[PASSWORD]=%2503d%2500a2%2540%2526%250D%2516%250923%251Bu%2509%252C%250D%2522%2507Vg%2523%2504%250E; Hm_lvt_9c7f4d9b7c00cb5aba2c637c64a41567=1459236700; Hm_lpvt_9c7f4d9b7c00cb5aba2c637c64a41567=1459240287; main[XWJOKE]=hoho' -H 'Connection: keep-alive' -H 'Referer: http://www.newsmth.net/nForum/' --data 'title=%E6%B5%A6%E5%8F%91AE+%E7%99%BD%E9%87%91%E5%8D%A1%E9%82%80%E8%AF%B7%E9%93%BE%E6%8E%A5%7E%7E%7E&content=hi%EF%BC%8C%0A%0A%E6%8E%A8%E8%8D%90%E9%93%BE%E6%8E%A5%E5%A6%82%E4%B8%8B%EF%BC%8CAE%E7%99%BD%E5%9C%A8%E3%80%90%E5%8D%93%E8%B6%8A%E7%99%BD%E9%87%91%E3%80%91%E6%A0%8F%E7%9B%AE%E4%B8%8B%E7%9A%84%E7%AC%AC%E4%B8%89%E9%A1%B5%E3%80%90%E7%BE%8E%E8%BF%90%E7%99%BD%E9%87%91%E5%8D%A1%E3%80%91%EF%BC%8C%E4%BD%BF%E7%94%A8%E6%8E%A8%E8%8D%90%E9%93%BE%E6%8E%A5%E7%94%B3%E8%AF%B7%E6%88%90%E5%8A%9F%E4%BC%9A%E6%9C%89300%E5%88%B7%E5%8D%A1%E9%87%91%E5%A5%96%E5%8A%B1%EF%BC%88%E6%8E%A8%E8%8D%90%E4%BA%BA200%EF%BC%89%EF%BC%8C%E7%9B%B4%E6%8E%A5%E7%94%B3%E8%AF%B7%E6%B2%A1%E6%9C%89%E5%A5%96%E5%8A%B1%E3%80%82%E3%80%82%E3%80%82%E6%89%80%E4%BB%A5%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8%E6%8E%A8%E8%8D%90%E9%93%BE%E6%8E%A5%E7%94%B3%E8%AF%B7%E5%90%A7%EF%BC%8C%E5%B7%B2%E6%8E%A8%E8%8D%90%E5%8D%81%E5%A4%9A%E4%BA%BA%EF%BC%8C%E6%88%90%E5%8A%9F%E7%8E%87%E8%BE%83%E9%AB%98%EF%BC%8C%E7%A5%9D%E5%A5%BD%E8%BF%90~%0A%0A%E6%8E%A8%E8%8D%90%E9%93%BE%E6%8E%A5%EF%BC%9Ahttps%3A%2F%2Fecentre.spdbccc.com.cn%2Fentry_cobber_union%2FpageController%2FmySticker.htm%3Fcid%3D365746+%0A%0AAE%E7%99%BD%E5%85%B6%E5%AE%83%E4%BF%A1%E6%81%AF%EF%BC%9Ahttp%3A%2F%2Fwww.newsmth.net%2FnForum%2F%23!article%2FCreditCard%2F184153&num=&signature=0&backup=on&id='$user -H 'Cookie: _ga=GA1.2.316291097.1429852824; Hm_lvt_7734e0ab76401586c0e18dc2feefc01b=1441631966; bfd_g=9de2782bcb754fd70000689300906e3054c9fda8; tma=88525828.7971704.1429693672137.1449543590241.1449629553140.142; tmd=2533.88525828.7971704.1429693672137.; main[UTMPUSERID]=gomypig; main[UTMPKEY]=28696048; main[UTMPNUM]=12483; main[PASSWORD]=%2503d%2500a2%2540%2526%250D%2516%250923%251Bu%2509%252C%250D%2522%2507Vg%2523%2504%250E; main[XWJOKE]=hoho; Hm_lvt_9c7f4d9b7c00cb5aba2c637c64a41567=1457776174,1457915149,1458001000,1458957533; Hm_lpvt_9c7f4d9b7c00cb5aba2c637c64a41567=1459236059' -H 'Origin: http://www.newsmth.net' -H 'Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4' -H 'Pragma: no-cache' -H 'Accept-Encoding: gzip, deflate'  --compressed | iconv -f GBK -t UTF-8)

if [[ $? -eq 0 ]];then
    echo "Send invitation success: $result" | mail -s 'NOTICE:[smth_spider]' yanlong@baidu.com,scicodist@gmail.com
else
    echo "Send invitation failed: $result" | mail -s 'WARN:[smth_spider]' yanlong@baidu.com,scicodist@gmail.com
fi
